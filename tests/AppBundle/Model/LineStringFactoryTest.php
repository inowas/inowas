<?php

namespace tests\AppBundle\Model;


use AppBundle\Model\LineStringFactory;
use CrEOF\Spatial\PHP\Types\Geometry\LineString;

class LineStringFactoryTest extends \PHPUnit_Framework_TestCase
{
    protected $latLngsJsonString;

    protected $latLngs;

    public function setUp()
    {
        $this->latLngsJsonString = '[{"lat":-31.35192,"lng":-63.65373},{"lat":-31.351764794584,"lng":-63.653645516024},{"lat":-31.349749064959,"lng":-63.651242256747},{"lat":-31.347546983301,"lng":-63.645467759343},{"lat":-31.346594055584,"lng":-63.64392280695},{"lat":-31.342415720095,"lng":-63.640060425969},{"lat":-31.341096207173,"lng":-63.639030457707},{"lat":-31.340949593483,"lng":-63.637914658757},{"lat":-31.333844665427872,"lng":-63.63693237304687},{"lat":-31.341389433866,"lng":-63.634138108464},{"lat":-31.341242820633,"lng":-63.629417420598},{"lat":-31.341829272192,"lng":-63.627786637517},{"lat":-31.343295385094,"lng":-63.626585007878},{"lat":-31.345347904772,"lng":-63.626070023747},{"lat":-31.346374147817,"lng":-63.625984193059},{"lat":-31.346887265141,"lng":-63.624610902043},{"lat":-31.347327077762,"lng":-63.622636796208},{"lat":-31.34813339556,"lng":-63.621606827946},{"lat":-31.349746010418,"lng":-63.621349335881},{"lat":-31.351285298808,"lng":-63.621349335881},{"lat":-31.35238477509,"lng":-63.620491028996},{"lat":-31.352677966594,"lng":-63.619375230046},{"lat":-31.352824562004,"lng":-63.618345261784},{"lat":-31.352604668804,"lng":-63.616971970769},{"lat":-31.351798389339,"lng":-63.616285325261},{"lat":-31.351358597627,"lng":-63.614997864934},{"lat":-31.351798389339,"lng":-63.612852097722},{"lat":-31.351065402009,"lng":-63.611049653264},{"lat":-31.349086307681,"lng":-63.60898971674},{"lat":-31.347473681512,"lng":-63.607530595036},{"lat":-31.346154239536,"lng":-63.605556489201},{"lat":-31.344028432977,"lng":-63.604955674382},{"lat":-31.342928859011,"lng":-63.60504150507},{"lat":-31.341096207173,"lng":-63.607530595036},{"lat":-31.339190211392,"lng":-63.60959053156},{"lat":-31.337650725074,"lng":-63.608732224675},{"lat":-31.336037902868,"lng":-63.60787391779},{"lat":-31.334864923902,"lng":-63.606586457463},{"lat":-31.334718300503,"lng":-63.60452652094},{"lat":-31.335451415212,"lng":-63.602552415105},{"lat":-31.336917627498,"lng":-63.601608277531},{"lat":-31.338237199022,"lng":-63.600063325139},{"lat":-31.338383816938,"lng":-63.598260880681},{"lat":-31.338677052084,"lng":-63.59602928278},{"lat":-31.337724034517,"lng":-63.595342637273},{"lat":-31.336184524211,"lng":-63.595771790715},{"lat":-31.334864923902,"lng":-63.595771790715},{"lat":-31.333691930314,"lng":-63.595085145207},{"lat":-31.332738862259,"lng":-63.594226838322},{"lat":-31.332518922106,"lng":-63.592767716618},{"lat":-31.333471992389,"lng":-63.591480256291},{"lat":-31.334938235515,"lng":-63.59096527216},{"lat":-31.336477766211,"lng":-63.590793610783},{"lat":-31.337870653233,"lng":-63.590192795964},{"lat":-31.338237199022,"lng":-63.589162827702},{"lat":-31.338603743383,"lng":-63.587446213933},{"lat":-31.338310508009,"lng":-63.585729600163},{"lat":-31.337504106016,"lng":-63.584098817082},{"lat":-31.337504106016,"lng":-63.58255386469},{"lat":-31.337577415573,"lng":-63.580493928166},{"lat":-31.336257834797,"lng":-63.578691483708},{"lat":-31.33429,"lng":-63.57684}]';
        $this->latLngs = json_decode($this->latLngsJsonString);
    }

    public function testLatLngJsonStringIsValidJson(){
        $this->assertJson($this->latLngsJsonString);
    }

    public function testLatLngJsonCanBeConvertedAndIsArray(){
        $this->assertTrue(is_array(json_decode($this->latLngsJsonString)));
    }

    public function testLatLngJsonHas62Elements(){
        $this->assertCount(62, json_decode($this->latLngsJsonString));
    }

    public function testCreateLineString(){
        $this->assertInstanceOf(LineString::class, LineStringFactory::fromLatLngs(json_decode($this->latLngsJsonString)));
    }
}
